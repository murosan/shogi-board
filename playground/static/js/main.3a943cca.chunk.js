(this["webpackJsonpshogi-board"]=this["webpackJsonpshogi-board"]||[]).push([[0],Array(38).concat([function(e,t,n){e.exports=n.p+"static/media/1.53ae04ea.svg"},function(e,t,n){e.exports=n.p+"static/media/2.97f27bd3.svg"},function(e,t,n){e.exports=n.p+"static/media/3.b1be70d0.svg"},function(e,t,n){e.exports=n.p+"static/media/4.3a3645e1.svg"},function(e,t,n){e.exports=n.p+"static/media/5.96880164.svg"},function(e,t,n){e.exports=n.p+"static/media/6.eed8b457.svg"},function(e,t,n){e.exports=n.p+"static/media/7.f7756286.svg"},function(e,t,n){e.exports=n.p+"static/media/8.091df296.svg"},function(e,t,n){e.exports=n.p+"static/media/9.2a50e523.svg"},function(e,t,n){e.exports=n.p+"static/media/1.6deb9f45.svg"},function(e,t,n){e.exports=n.p+"static/media/2.d7945250.svg"},function(e,t,n){e.exports=n.p+"static/media/3.41251812.svg"},function(e,t,n){e.exports=n.p+"static/media/4.b9435843.svg"},function(e,t,n){e.exports=n.p+"static/media/5.617112e9.svg"},function(e,t,n){e.exports=n.p+"static/media/6.d05bf0e7.svg"},function(e,t,n){e.exports=n.p+"static/media/7.b426a2a3.svg"},function(e,t,n){e.exports=n.p+"static/media/8.33901adb.svg"},function(e,t,n){e.exports=n.p+"static/media/9.f4885e44.svg"},function(e,t,n){e.exports=n.p+"static/media/configuration.3bb39912.svg"},function(e,t,n){e.exports=n.p+"static/media/connect-to-engine.83c1b041.svg"},function(e,t,n){e.exports=n.p+"static/media/kifu.12594d8c.svg"},function(e,t,n){e.exports=n.p+"static/media/next-five.af1deb21.svg"},function(e,t,n){e.exports=n.p+"static/media/next-one.23a7a57e.svg"},function(e,t,n){e.exports=n.p+"static/media/prev-five.b79ad6a0.svg"},function(e,t,n){e.exports=n.p+"static/media/prev-one.8e9ec7d7.svg"},function(e,t,n){e.exports=n.p+"static/media/reverse.13ea1c9a.svg"},function(e,t,n){e.exports=n.p+"static/media/stop-engine.d8f88815.svg"},,function(e,t,n){e.exports=n(129)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(67);var r,a,o,i,c,u,s,l,p,f,v,m,h,b,d,w,g,y,k=n(0),O=n.n(k),j=n(24),x=n.n(j),E=n(4),C=n(1),N=n.n(C),S=n(5),R=n(6),T=n(8),L=n(9),P=n(3),M=(n(12),n(2)),W=n(16),U=n.n(W),B=(r=function(){function e(){var t=this;Object(T.a)(this,e),Object(R.a)(this,"paintTargets",a,this),Object(R.a)(this,"serverURL",o,this),Object(R.a)(this,"saveToLocalStorage",i,this),Object(R.a)(this,"saveBoardWidth",c,this),Object(R.a)(this,"appWidth",u,this),this.keys={paintTargets:"paintTargets",serverURL:"serverURL",saveToLocalStorage:"saveToLocalStorage",saveBoardWidth:"saveBoardWidth",appWidth:"appWidth"},this.saveAppWidth=U()((function(e){return t.set(t.keys.appWidth,"".concat(e))}),1e3);var n=this.keys,r=n.paintTargets,s=n.serverURL,l=n.saveToLocalStorage,p=n.saveBoardWidth,f=n.appWidth;this.paintTargets=!("false"===this.get(r)),this.serverURL=this.get(s)||"",this.saveToLocalStorage="true"===this.get(l),this.saveBoardWidth="true"===this.get(p),this.appWidth=function(){if(!t.saveBoardWidth)return null;var e=t.get(f);if(!e)return null;var n=Number(e);return isNaN(n)?null:n}()}return Object(L.a)(e,[{key:"setPaintTargets",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.paintTargets=t,this.saveToLocalStorage&&this.set(this.keys.paintTargets,String(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setServerURL",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.serverURL=t,this.saveToLocalStorage&&this.set(this.keys.serverURL,t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setSaveToLocalStorage",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n,r,a,o,i=this;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.saveToLocalStorage=t,n=this.keys,r=n.saveToLocalStorage,a=n.serverURL,o=n.paintTargets,!this.saveToLocalStorage){e.next=7;break}return this.set(r,"".concat(t)),this.set(a,this.serverURL),this.set(o,"".concat(this.paintTargets)),e.abrupt("return");case 7:[r,a,o].forEach((function(e){return i.remove(e)}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setSaveBoardWidth",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.saveBoardWidth=t,t){e.next=5;break}return this.remove(this.keys.saveBoardWidth),this.remove(this.keys.appWidth),e.abrupt("return");case 5:this.set(this.keys.saveBoardWidth,"true"),(n=this.appWidth)&&this.saveAppWidth(n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setAppWidth",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return this.appWidth=null,this.remove(this.keys.appWidth),e.abrupt("return");case 4:this.appWidth=t,this.saveBoardWidth&&this.saveAppWidth(t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){localStorage.setItem(e,t)}},{key:"get",value:function(e){return localStorage.getItem(e)}},{key:"remove",value:function(e){localStorage.removeItem(e)}}]),e}(),a=Object(P.a)(r.prototype,"paintTargets",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(P.a)(r.prototype,"serverURL",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=Object(P.a)(r.prototype,"saveToLocalStorage",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(P.a)(r.prototype,"saveBoardWidth",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(P.a)(r.prototype,"appWidth",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(r.prototype,"setPaintTargets",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"setPaintTargets"),r.prototype),Object(P.a)(r.prototype,"setServerURL",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"setServerURL"),r.prototype),Object(P.a)(r.prototype,"setSaveToLocalStorage",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"setSaveToLocalStorage"),r.prototype),Object(P.a)(r.prototype,"setSaveBoardWidth",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"setSaveBoardWidth"),r.prototype),Object(P.a)(r.prototype,"setAppWidth",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"setAppWidth"),r.prototype),r),D=(s=function(){function e(){Object(T.a)(this,e),Object(R.a)(this,"mockup",l,this),Object(R.a)(this,"resizing",p,this)}return Object(L.a)(e,[{key:"setMockupState",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mockup=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeMockup",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mockup=1;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setResizing",value:function(e){this.resizing=e}}]),e}(),l=Object(P.a)(s.prototype,"mockup",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),p=Object(P.a)(s.prototype,"resizing",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(P.a)(s.prototype,"setMockupState",[M.action],Object.getOwnPropertyDescriptor(s.prototype,"setMockupState"),s.prototype),Object(P.a)(s.prototype,"closeMockup",[M.action],Object.getOwnPropertyDescriptor(s.prototype,"closeMockup"),s.prototype),Object(P.a)(s.prototype,"setResizing",[M.action],Object.getOwnPropertyDescriptor(s.prototype,"setResizing"),s.prototype),s),I=n(7),z=n(22),K=n.n(z),A=n(36),V=n.n(A);function F(e,t,n){if(8===t||-8===t||t>10)throw new Error("Piece ID of Captures must not be Gyoku or over 10.");return e.map((function(e,r){if(r!==t-1)return e;var a=n(e);if(a<0)throw new Error("Invalid function call. Captures must not contain negative value.");return a}))}function _(e){return e>0?e+10:e-10}function G(e){return Math.abs(e)<10?e:e<0?e+10:e-10}function q(e){if(-1===e.sourceRow)return!1;var t=0!==e.piece&&5!==Math.abs(e.piece)&&Math.abs(e.piece)<=7,n=e.piece>0?[0,1,2]:[6,7,8],r=n.includes(e.sourceRow)||n.includes(e.destRow);return t&&r}function J(e){var t=function(t,n){if(e.pos.turn!==n)return t.slice();var r=e.pos.pos[e.dest.row][e.dest.column];return r*n<0?function(e,t){return F(e,Math.abs(t),(function(e){return e+1}))}(t,G(r)):-1===e.source.row&&-1===e.source.column?function(e,t){return F(e,Math.abs(t),(function(e){return e-1}))}(t,e.piece):t.slice()},n=t(e.pos.cap0,1),r=t(e.pos.cap1,-1);return{pos:X(e),cap0:n,cap1:r,turn:-e.pos.turn,moveCount:e.pos.moveCount+1}}function H(e){return{pos:X(e),cap0:e.pos.cap0.slice(),cap1:e.pos.cap1.slice(),turn:-e.pos.turn,moveCount:e.pos.moveCount+1}}function X(e){return e.pos.pos.map((function(t,n){return t.map((function(t,r){return e.source.row===n&&e.source.column===r?0:e.dest.row===n&&e.dest.column===r?e.piece:t}))}))}var $,Q,Y,Z,ee,te,ne,re=function(){function e(t){Object(T.a)(this,e),this.name=void 0,this.name=t}return Object(L.a)(e,[{key:"setValue",value:function(e){}}]),e}(),ae=(f=function(){function e(t,n,r){Object(T.a)(this,e),Object(R.a)(this,"value",v,this),this.name=void 0,this.default=void 0,this.name=t,this.value=n,this.default=r}return Object(L.a)(e,[{key:"setValue",value:function(e){this.value=e}}]),e}(),v=Object(P.a)(f.prototype,"value",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(f.prototype,"setValue",[M.action],Object.getOwnPropertyDescriptor(f.prototype,"setValue"),f.prototype),f),oe=(m=function(){function e(t,n,r,a,o){Object(T.a)(this,e),Object(R.a)(this,"value",h,this),Object(R.a)(this,"inputValue",b,this),this.name=void 0,this.default=void 0,this.min=void 0,this.max=void 0,this.name=t,this.value=n,this.inputValue=n.toString(),this.default=r,this.min=a,this.max=o}return Object(L.a)(e,[{key:"setValue",value:function(e){this.inputValue=e;var t=Number(this.inputValue);Number.isNaN(t)||t<this.min||t>this.max||(this.value=t)}}]),e}(),h=Object(P.a)(m.prototype,"value",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(P.a)(m.prototype,"inputValue",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(m.prototype,"setValue",[M.action],Object.getOwnPropertyDescriptor(m.prototype,"setValue"),m.prototype),m),ie=(d=function(){function e(t,n,r,a){Object(T.a)(this,e),Object(R.a)(this,"value",w,this),this.name=void 0,this.default=void 0,this.vars=void 0,this.name=t,this.value=n,this.default=r,this.vars=a}return Object(L.a)(e,[{key:"setValue",value:function(e){this.value=e}}]),e}(),w=Object(P.a)(d.prototype,"value",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(d.prototype,"setValue",[M.action],Object.getOwnPropertyDescriptor(d.prototype,"setValue"),d.prototype),d),ce=(g=function(){function e(t,n,r){Object(T.a)(this,e),Object(R.a)(this,"value",y,this),this.name=void 0,this.default=void 0,this.name=t,this.value=n,this.default=r}return Object(L.a)(e,[{key:"setValue",value:function(e){this.value=e}}]),e}(),y=Object(P.a)(g.prototype,"value",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(g.prototype,"setValue",[M.action],Object.getOwnPropertyDescriptor(g.prototype,"setValue"),g.prototype),g),ue=function(){function e(t,n){var r=this;Object(T.a)(this,e),this._engineName=void 0,this._serverURL=void 0,this.engineNameKey="key",this.updateRange=U()(function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.post("options/update/range",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),1e3),this.updateText=U()(function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.post("options/update/text",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),1e3),this._engineName=t,this._serverURL=n}return Object(L.a)(e,[{key:"init",value:function(){var e=Object(S.a)(N.a.mark((function e(){var t,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildUrl("init",!1);case 2:return t=e.sent,e.next=5,K.a.post(t);case 5:return n=e.sent,e.abrupt("return",n.data);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("connect");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("close");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("start");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("stop");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOptions",value:function(){var e=Object(S.a)(N.a.mark((function e(){var t,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("options/get");case 2:return t=e.sent,n={buttons:new Map,checks:new Map,ranges:new Map,selects:new Map,texts:new Map},Object.values(t.buttons).forEach((function(e){return n.buttons.set(e.name,new re(e.name))})),Object.values(t.checks).forEach((function(e){return n.checks.set(e.name,new ae(e.name,e.value,e.default))})),Object.values(t.ranges).forEach((function(e){return n.ranges.set(e.name,new oe(e.name,e.value,e.default,e.min,e.max))})),Object.values(t.selects).forEach((function(e){return n.selects.set(e.name,new ie(e.name,e.value,e.default,e.vars))})),Object.values(t.texts).forEach((function(e){return n.texts.set(e.name,new ce(e.name,e.value,e.default))})),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateButton",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("options/update/button",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCheck",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("options/update/check",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateSelect",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("options/update/select",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getResult",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("result/get");case 2:return n=e.sent,r=t.pos,e.abrupt("return",Object.entries(n).sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})).map((function(e){var n=Object(I.a)(e,2),a=(n[0],n[1]),o=0;r=t.pos;var i=[];try{for(;o<a.moves.length;){var c=a.moves[o],u={row:c.source.row,column:c.source.column},s={row:c.dest.row,column:c.dest.column},l=c.pieceId||r.pos[u.row][u.column];if(0===l)break;var p={pos:r,source:u,dest:s,piece:l,promote:c.isPromoted};i.push(p),r=J(p),o=o+1|0}}catch(v){}var f=new Map;return Object.entries(a.values).forEach((function(e){var t=Object(I.a)(e,2),n=t[0],r=t[1];return f.set(n,r)})),{id:V.a.generate(),values:f,score:a.score*t.pos.turn,moves:i}})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setPosition",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={pos:t.pos.map((function(e){return e.slice().reverse()})),cap0:t.cap0,cap1:t.cap1,turn:t.turn,moveCount:t.moveCount},e.next=3,this.post("position/set",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildUrl(t,!0);case 2:return n=e.sent,e.next=5,K.a.get(n);case 5:return r=e.sent,e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(S.a)(N.a.mark((function e(t,n){var r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildUrl(t,!0);case 2:return r=e.sent,e.next=5,K.a.post(r,n,{headers:{"Content-Type":"application/json"}});case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"buildUrl",value:function(){var e=Object(S.a)(N.a.mark((function e(t,n){var r,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e){return encodeURIComponent(e)},a=n?"?".concat(this.engineNameKey,"=").concat(r(this.engineName)):"",e.abrupt("return","".concat(this.serverURL,"/").concat(t).concat(a));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"e",value:function(e){return encodeURIComponent(e)}},{key:"engineName",set:function(e){this._engineName=e},get:function(){if(!this._engineName)throw new Error("engineName is not defined.");return this._engineName}},{key:"serverURL",set:function(e){this._serverURL=e},get:function(){if(!this._serverURL)throw new Error("serverURL is not defined. serverURL");return this._serverURL}}]),e}(),se=($=function(){function e(){Object(T.a)(this,e),Object(R.a)(this,"names",Q,this),Object(R.a)(this,"current",Y,this),Object(R.a)(this,"options",Z,this),Object(R.a)(this,"state",ee,this),Object(R.a)(this,"result",te,this),Object(R.a)(this,"serverURL",ne,this)}return Object(L.a)(e,[{key:"setNames",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.names=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setState",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.names.includes(t)){e.next=2;break}throw new Error("Unknown engine name. name="+t);case 2:return this.current=t,e.prev=3,this.setState(1),e.next=7,this.sbclient.connect();case 7:return e.next=9,this.sbclient.getOptions();case 9:this.options=e.sent,this.setState(2),e.next=19;break;case 13:return e.prev=13,e.t0=e.catch(3),console.error("Failed to connect",e.t0),alert("\u63a5\u7d9a\u306b\u5931\u6557\u3057\u307e\u3057\u305f"),e.next=19,this.disconnect();case 19:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.sbclient.close();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("\u63a5\u7d9a\u89e3\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f",e.t0);case 8:return e.prev=8,this.current=null,this.options=null,this.state=0,e.finish(8);case 13:case"end":return e.stop()}}),e,this,[[0,5,8,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"startThinking",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.current){e.next=2;break}throw new Error("[startThinking] current engine is not set");case 2:return e.next=4,this.sbclient.start();case 4:return e.next=6,this.setState(4);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopThinking",value:function(){var e=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.current){e.next=2;break}throw new Error("[stopThinking] current engine is not set");case 2:if(4===this.state){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.sbclient.stop();case 6:return e.next=8,this.setState(3);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setResult",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.result=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updatePosition",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sbclient.setPosition(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setServerURL",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.serverURL=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sbclient",get:function(){return new ue(this.current||"",this.serverURL)}}]),e}(),Q=Object(P.a)($.prototype,"names",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Y=Object(P.a)($.prototype,"current",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=Object(P.a)($.prototype,"options",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=Object(P.a)($.prototype,"state",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),te=Object(P.a)($.prototype,"result",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=Object(P.a)($.prototype,"serverURL",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(P.a)($.prototype,"sbclient",[M.computed],Object.getOwnPropertyDescriptor($.prototype,"sbclient"),$.prototype),Object(P.a)($.prototype,"setNames",[M.action],Object.getOwnPropertyDescriptor($.prototype,"setNames"),$.prototype),Object(P.a)($.prototype,"setState",[M.action],Object.getOwnPropertyDescriptor($.prototype,"setState"),$.prototype),Object(P.a)($.prototype,"connect",[M.action],Object.getOwnPropertyDescriptor($.prototype,"connect"),$.prototype),Object(P.a)($.prototype,"disconnect",[M.action],Object.getOwnPropertyDescriptor($.prototype,"disconnect"),$.prototype),Object(P.a)($.prototype,"startThinking",[M.action],Object.getOwnPropertyDescriptor($.prototype,"startThinking"),$.prototype),Object(P.a)($.prototype,"stopThinking",[M.action],Object.getOwnPropertyDescriptor($.prototype,"stopThinking"),$.prototype),Object(P.a)($.prototype,"setResult",[M.action],Object.getOwnPropertyDescriptor($.prototype,"setResult"),$.prototype),Object(P.a)($.prototype,"setServerURL",[M.action],Object.getOwnPropertyDescriptor($.prototype,"setServerURL"),$.prototype),$);function le(e){return"branches"in e}function pe(e,t,n){var r=e.moves.length-1,a=e.moves[r],o=e.moves.slice(0,r),i=t<=r?0:t-r;return{moves:le(a)?o.concat(function(e,t,n){var r=0===t&&void 0!==n?n:e.index;return 0===t?{branches:e.branches.map((function(e){return pe(e,0)})),index:r}:{branches:e.branches.map((function(r,a){return a===e.index?pe(r,t,n):r})),index:r}}(a,i,n)):e.moves.slice(),index:t<=r?t:r}}var fe=n(21),ve=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"],me=["\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"],he=function(e,t,n){for(var r=[],a=0;a<9;a++)if(!t||!t.includes(a))for(var o=0;o<9;o++){n&&n.includes(o)||0!==e[a][o]||r.push({row:a,column:o})}return r},be=function(e,t,n){for(var r=[],a=0;a<t.length;a++){var o=t[a][0],i=t[a][1];o>=0&&o<=8&&i>=0&&i<=8&&e[o][i]*n<=0&&r.push({row:o,column:i})}return r};function de(e,t){return e.row-t.row||e.column-t.column}function we(e,t){for(var n=e.length>>1,r=0,a=e.length-1;r<=a;){if(e[n].row===t.row&&e[n].column===t.column)return n;e[n].row<t.row?r=n+1:e[n].row>t.row?a=n-1:e[n].column<t.column?r=n+1:a=n-1,n=r+(a-r>>1)}return-1}var ge=function(e,t,n,r,a,o,i){for(;0<=t&&t<=8&&0<=n&&n<=8;){var c=e[t][n];if(c*r>0)break;if(a.push({row:t,column:n}),c*r<0)break;t+=o,n+=i}},ye=function(e,t){if(!t.piece||7!==t.piece&&-7!==t.piece)throw new Error("Called validation for hisha, but piece id was not hisha.");if(-1===t.row&&-1===t.column)return he(e.pos);for(var n=[[-1,0],[0,-1],[0,1],[1,0]],r=[],a=0;a<n.length;a++)ge(e.pos,t.row+n[a][0],t.column+n[a][1],t.piece,r,n[a][0],n[a][1]);return r.sort(de),r},ke=function(e,t){if(!t.piece||6!==t.piece&&-6!==t.piece)throw new Error("Called validation for kaku, but piece id was not kaku.");if(-1===t.row&&-1===t.column)return he(e.pos);for(var n=[[-1,-1],[-1,1],[1,-1],[1,1]],r=[],a=0;a<n.length;a++)ge(e.pos,t.row+n[a][0],t.column+n[a][1],t.piece,r,n[a][0],n[a][1]);return r.sort(de),r};function Oe(e,t){var n=t.piece;if(0===n)throw new Error("Cannot get targets to move for empty cell.");if(1===n||-1===n)return function(e,t){if(!t.piece||1!==t.piece&&-1!==t.piece)throw new Error("Called validation for fu, but piece id was not fu.");for(var n=[],r=0;r<9;r++)for(var a=0;a<9;a++)if(e.pos[a][r]===t.piece){n.push(r);break}if(-1===t.row&&-1===t.column){var o=t.piece>0?0:8;return he(e.pos,[o],n)}var i=t.piece>0?t.row-1:t.row+1;return i<0||i>8||e.pos[i][t.column]*t.piece>0?[]:[{row:i,column:t.column}]}(e,t);if(2===n||-2===n)return function(e,t){if(!t.piece||2!==t.piece&&-2!==t.piece)throw new Error("Called validation for kyou, but piece id was not kyou.");if(-1===t.row&&-1===t.column){var n=t.piece>0?0:8;return he(e.pos,[n])}var r=t.piece>0?-1:1,a=[];return ge(e.pos,t.row+r,t.column,t.piece,a,r,0),t.piece>0&&a.reverse(),a}(e,t);if(3===n||-3===n)return function(e,t){if(!t.piece||3!==t.piece&&-3!==t.piece)throw new Error("Called validation for kei, but piece id was not kei.");if(-1===t.row&&-1===t.column){var n=t.piece>0?0:8,r=t.piece>0?n+1:n-1;return he(e.pos,[n,r])}var a=t.piece>0?t.row-2:t.row+2;if(a<0||a>8)return[];var o=[[a,t.column-1],[a,t.column+1]];return be(e.pos,o,t.piece)}(e,t);if(4===n||-4===n)return function(e,t){if(!t.piece||4!==t.piece&&-4!==t.piece)throw new Error("Called validation for gin, but piece id was not gin.");if(-1===t.row&&-1===t.column)return he(e.pos);var n=t.piece>0?[[t.row-1,t.column-1],[t.row-1,t.column],[t.row-1,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column+1]]:[[t.row-1,t.column-1],[t.row-1,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column],[t.row+1,t.column+1]];return be(e.pos,n,t.piece)}(e,t);if(5===n||-5===n||11===n||-11===n||12===n||-12===n||13===n||-13===n||14===n||-14===n)return function(e,t){if(!t.piece||5!==t.piece&&-5!==t.piece&&11!==t.piece&&-11!==t.piece&&12!==t.piece&&-12!==t.piece&&13!==t.piece&&-13!==t.piece&&14!==t.piece&&-14!==t.piece)throw new Error("Called validation for kin(or promoted piece moves as same as kin), but piece id was not as expected.");if(-1===t.row&&-1===t.column)return he(e.pos);var n=t.piece>0?[[t.row-1,t.column-1],[t.row-1,t.column],[t.row-1,t.column+1],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column]]:[[t.row-1,t.column],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column],[t.row+1,t.column+1]];return be(e.pos,n,t.piece)}(e,t);if(6===n||-6===n)return ke(e,t);if(7===n||-7===n)return ye(e,t);if(8===n||-8===n)return function(e,t){if(!t.piece||8!==t.piece&&-8!==t.piece)throw new Error("Called validation for gyoku, but piece id was not gyoku.");if(-1===t.row&&-1===t.column)throw new Error("Gyoku must not be captured");var n=[[t.row-1,t.column-1],[t.row-1,t.column],[t.row-1,t.column+1],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column],[t.row+1,t.column+1]];return be(e.pos,n,t.piece)}(e,t);if(16===n||-16===n)return function(e,t){if(!t.piece||16!==t.piece&&-16!==t.piece)throw new Error("Called validation for uma, but piece id was not uma.");if(-1===t.row||-1===t.column)throw new Error("Uma must not be captured");var n=[[t.row-1,t.column],[t.row,t.column-1],[t.row,t.column+1],[t.row+1,t.column]],r={row:t.row,column:t.column,piece:G(t.piece)},a=ke(e,r),o=be(e.pos,n,t.piece).concat(a);return o.sort(de),o}(e,t);if(17===n||-17===n)return function(e,t){if(!t.piece||17!==t.piece&&-17!==t.piece)throw new Error("Called validation for ryu, but piece id was not ryu.");if(-1===t.row||-1===t.column)throw new Error("Ryu must not be captured");var n=[[t.row-1,t.column-1],[t.row-1,t.column+1],[t.row+1,t.column-1],[t.row+1,t.column+1]],r={row:t.row,column:t.column,piece:G(t.piece)},a=ye(e,r),o=be(e.pos,n,t.piece).concat(a);return o.sort(de),o}(e,t);throw new Error("Could not get targets to move. Got invalid piece ID")}function je(e){var t,n=e.source,r=e.dest,a=e.prevDest,o=e.piece,i=e.promote,c=e.pos,u=n.row,s=n.column,l=r.row,p=r.column,f=function(e){var t=Math.abs(e);if(1===t)return"\u6b69";if(2===t)return"\u9999";if(3===t)return"\u6842";if(4===t)return"\u9280";if(5===t)return"\u91d1";if(6===t)return"\u89d2";if(7===t)return"\u98db";if(8===t)return"\u7389";if(11===t)return"\u3068";if(12===t)return"\u6210\u9999";if(13===t)return"\u6210\u6842";if(14===t)return"\u6210\u9280";if(16===t)return"\u99ac";if(17===t)return"\u9f8d";throw new Error("Failed to ident piece name. received: "+e)}(i?G(o):o),v=ve[l],m=me[p];t=(null===a||void 0===a?void 0:a.row)===l&&(null===a||void 0===a?void 0:a.column)===p?"\u540c".concat(f):"".concat(m).concat(v).concat(f);var h=function(e,t){for(var n=e.row,r=e.column,a=e.piece,o=[],i=t.turn,c=t.pos,u=0;u<=8;u++)for(var s=0;s<=8;s++)if(u!==n||s!==r){var l=c[u][s];i*l>0&&l===a&&o.push({row:u,column:s,piece:a})}return o}({row:u,column:s,piece:o},c).filter((function(e){return Oe(c,e).some((function(e){var t=e.row,n=e.column;return t===l&&n===p}))})),b=h.length>0;return-1===u?b?"".concat(t,"\u6253"):t:(3===o||-3===o||7===o||-7===o||6===o||-6===o||17===o||-17===o||16===o||-16===o?t+=function(e,t){var n=e.source,r=e.dest,a=e.pos.turn;if(!t)return"";var o=n.row,i=n.column,c=r.row,u=t.row,s=t.column;if(o===c&&u!==c)return"\u5bc4";if(o===c&&u===c||Ee(o,c,a)&&Ee(u,c,a)||xe(o,c,a)&&xe(u,c,a))return Ce(i,s,a)?"\u5de6":"\u53f3";return Ee(o,u,a)?"\u5f15":"\u4e0a"}(e,h[0]):8!==o&&-8!==o&&1!==o&&-1!==o&&2!==o&&-2!==o&&(t+=function(e,t){var n=e.source,r=e.dest,a=e.pos.turn;if(0===t.length)return"";var o,i=n.row,c=n.column,u=r.row,s=r.column,l={sameRow:i===u,sameCol:c===s,below:xe(i,u,a),above:Ee(i,u,a),left:Ce(c,s,a),right:Ne(c,s,a)},p={sameRow:!1,below:!1,above:!1,left:!1,right:!1},f=Object(fe.a)(t);try{for(f.s();!(o=f.n()).done;){var v=o.value,m=v.row,h=v.column;m===u&&(p.sameRow=!0),xe(m,u,a)&&(p.below=!0),Ee(m,u,a)&&(p.above=!0),Ce(h,s,a)&&(p.left=!0),Ne(h,s,a)&&(p.right=!0)}}catch(b){f.e(b)}finally{f.f()}return l.below&&!p.below?"\u4e0a":l.below&&l.sameCol?"\u76f4":l.above&&!p.above?"\u5f15":l.sameRow&&!p.sameRow?"\u5bc4":l.left&&!p.left?"\u5de6":l.right&&!p.right?"\u53f3":l.sameRow&&l.left?"\u5de6\u5bc4":l.sameRow?"\u53f3\u5bc4":l.below&&l.left?"\u5de6\u4e0a":l.below?"\u53f3\u4e0a":l.above&&l.left?"\u5de6\u5f15":"\u53f3\u5f15"}(e,h)),i?t+="\u6210":!1===i&&q({sourceRow:u,destRow:l,piece:o})&&(t+="\u4e0d\u6210"),t)}function xe(e,t,n){return(e-t)*n>0}function Ee(e,t,n){return(e-t)*n<0}function Ce(e,t,n){return(e-t)*n>0}function Ne(e,t,n){return(e-t)*n<0}var Se=function(e){for(var t=e.history,n=t.moves[t.index];le(n);)n=(t=n.branches[n.index]).moves[t.index];return n},Re=function(e,t){return{meta:e.meta,history:Te(e.history,t)}};function Te(e,t){var n=e.index===e.moves.length-1,r=e.moves[e.index];if(n&&le(r))return{moves:e.moves.slice(0,e.moves.length-1).concat(Le(r,t,!0)),index:e.index};var a=e.index+1;if(n)return{moves:e.moves.concat(t),index:a};var o=e.moves[a],i=e.moves.slice(0,a);if(le(o))return{moves:i.concat(Le(o,t,!1)),index:a};if(We(t,o))return{moves:e.moves.slice(),index:a};var c=e.moves.slice(a,e.moves.length);return{moves:i.concat(Pe(c,t)),index:a}}function Le(e,t,n){if(n)return{branches:e.branches.map((function(n,r){return r===e.index?Te(n,t):n})),index:e.index};var r=e.branches.findIndex((function(e){return We(e.moves[0],t)}));return-1!==r?{branches:e.branches.slice(),index:r}:{branches:e.branches.concat(Me([t])),index:e.branches.length}}function Pe(e,t){return{branches:[Me(e),Me([t])],index:1}}function Me(e){return{moves:e,index:0}}function We(e,t){return e.index===t.index&&e.source.row===t.source.row&&e.source.column===t.source.column&&e.dest.row===t.dest.row&&e.dest.column===t.dest.column&&e.piece===t.piece&&e.promote===t.promote}var Ue=function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e.length;r++){var a=e[n][r];if(8===Math.abs(a)&&a*t>0)return{row:n,column:r,piece:a}}};function Be(e,t,n,r){for(var a=0;a<e.pos.length;a++)for(var o=0;o<e.pos.length;o++){var i=e.pos[a][o];if(!(i*n<=0))if(-1!==we(Oe(e,{row:a,column:o,piece:i}),t)){if(r||8!==Math.abs(i)||t.piece&&8===Math.abs(t.piece))return!0;if(!Be(H({pos:e,source:{row:a,column:o},dest:{row:t.row,column:t.column},piece:i}),t,-n,!0))return!0}}return!1}var De={hirate:"\u5e73\u624b",kyouOti:"\u9999\u843d\u3061",migiKyouOti:"\u53f3\u9999\u843d\u3061",ryouKyouOti:"\u4e21\u9999\u843d\u3061",kakuOti:"\u89d2\u843d\u3061",hishaOti:"\u98db\u8eca\u843d\u3061",hishaKyouOti:"\u98db\u8eca\u9999\u843d\u3061",hishaRyouKyouOti:"\u98db\u8eca\u4e21\u9999\u843d\u3061",nimaiOti:"\u4e8c\u679a\u843d\u3061",sannmaiOti:"\u4e09\u679a\u843d\u3061",yonnmaiOti:"\u56db\u679a\u843d\u3061",gomaiOti:"\u4e94\u679a\u843d\u3061",rokumaiOti:"\u516d\u679a\u843d\u3061",nanamaiOti:"\u4e03\u679a\u843d\u3061",hatimaiOti:"\u516b\u679a\u843d\u3061",kyuumaiOti:"\u4e5d\u679a\u843d\u3061",juumaiOti:"\u5341\u679a\u843d\u3061",ragyoku:"\u88f8\u7389"};function Ie(e){var t=De;return e===t.hirate?ze():e===t.kyouOti?Ke():e===t.migiKyouOti?Ae():e===t.ryouKyouOti?Ve():e===t.kakuOti?Fe():e===t.hishaOti?_e():e===t.hishaKyouOti?Ge():e===t.hishaRyouKyouOti?qe():e===t.nimaiOti?Je(2):e===t.sannmaiOti?Je(3):e===t.yonnmaiOti?Je(4):e===t.gomaiOti?Je(5):e===t.rokumaiOti?Je(6):e===t.nanamaiOti?Je(7):e===t.hatimaiOti?Je(8):e===t.kyuumaiOti?Je(9):e===t.juumaiOti?Je(10):e===t.ragyoku?He():ze()}var ze=function(){return Ze({pos:Xe()})},Ke=function(){return Qe([0,0])},Ae=function(){return Qe([8,0])},Ve=function(){return Qe([0,0],[8,0])},Fe=function(){return Qe([1,1])},_e=function(){return Qe([7,1])},Ge=function(){return Qe([7,1],[0,0])},qe=function(){return Qe([7,1],[0,0],[8,0])},Je=function(e){return $e(e)},He=function(){return Ye([[0,0,0,0,-8,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1],[0,7,0,0,0,0,0,6,0],[2,3,4,5,8,5,4,3,2]])};function Xe(){return[[-2,-3,-4,-5,-8,-5,-4,-3,-2],[0,-6,0,0,0,0,0,-7,0],[-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1],[0,7,0,0,0,0,0,6,0],[2,3,4,5,8,5,4,3,2]]}var $e=function(e){var t=[[1,1],[7,1]];return e>=3&&t.push([0,0]),e>=4&&t.push([8,0]),e>=5&&t.push([1,0]),e>=6&&t.push([7,0]),e>=7&&t.push([2,0]),e>=8&&t.push([6,0]),e>=9&&t.push([3,0]),e>=10&&t.push([5,0]),Qe.apply(void 0,t)};function Qe(){for(var e=[[-2,-3,-4,-5,-8,-5,-4,-3,-2],[0,-6,0,0,0,0,0,-7,0],[-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1],[0,7,0,0,0,0,0,6,0],[2,3,4,5,8,5,4,3,2]],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,o=n;a<o.length;a++){var i=Object(I.a)(o[a],2),c=i[0],u=i[1];e[u][c]=0}return Ye(e)}function Ye(e){return Ze({pos:e,turn:-1})}function Ze(e){var t=e.turn;return{pos:e.pos,cap0:[0,0,0,0,0,0,0],cap1:[0,0,0,0,0,0,0],turn:t||1,moveCount:0}}var et,tt,nt,rt,at,ot,it,ct="1";function ut(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De.hirate,t=Ie(e);return{meta:{version:ct,player:{sente:"",gote:""},handicap:e},history:{moves:[{index:0,str:"\u958b\u59cb\u5c40\u9762",pos:t,source:{row:-1,column:-1},dest:{row:-1,column:-1},piece:0}],index:0}}}var st,lt,pt,ft,vt,mt=(et=function(){function e(){Object(T.a)(this,e),Object(R.a)(this,"indexes",tt,this),Object(R.a)(this,"selected",nt,this),Object(R.a)(this,"confirm",rt,this),Object(R.a)(this,"moveTargets",at,this),Object(R.a)(this,"kifu",ot,this),Object(R.a)(this,"prevDestination",it,this)}return Object(L.a)(e,[{key:"reverse",value:function(){this.indexes=this.indexes.slice().reverse()}},{key:"clickPiece",value:function(e){var t=this,n=this.selected,r=this.currentMove.pos.turn;if(!this.confirm||!ht(e.clicked)){if(n&&ht(e.clicked)&&function(e,t){return e.row===t.row&&e.column===t.column&&e.piece===t.clicked&&e.i===t.i}(n,e))return this.selected=null,void(this.moveTargets=[]);if(ht(e.clicked)&&function(e,t){return e<0&&-1===t||e>0&&1===t}(e.clicked,r)){var a={row:e.row,column:e.column,piece:e.clicked,i:e.i};this.selected=a;var o=Oe(this.currentMove.pos,a),i=function e(t,n,r){if(!n.piece)throw new Error("piece id is needed");for(var a=n.piece>0?1:-1,o=Ue(t.pos,a),i=[],c=0;c<r.length;c++){var u=H({pos:t,source:{row:n.row,column:n.column},dest:{row:r[c].row,column:r[c].column},piece:n.piece});if(n.piece&&8===Math.abs(n.piece)&&(o=Ue(u.pos,a)),!(void 0!==o&&Be(u,o,-a))){var s=1===Math.abs(n.piece),l=-1===n.row,p=Ue(u.pos,-a);if(s&&l&&void 0!==p&&Be(u,p,a)){var f=Be(u,r[c],-a),v=e(u,p,Oe(u,p));if(!f&&0===v.length)continue}i.push(r[c])}}return i}(this.currentMove.pos,a,o);this.moveTargets=i}else{if(n&&n.piece)if(-1!==we(this.moveTargets,e)){var c={row:n.row,column:n.column},u={row:e.row,column:e.column},s=function(e,n){t.prevDestination=u;var r={pos:t.currentMove.pos,source:c,dest:u,prevDest:t.currentMove.dest,piece:e,promote:n},a=J(r),o=je(r),i={index:t.currentMove.index+1,str:o,pos:a,source:c,dest:u,piece:e,promote:n};t.setKifu(Re(t.kifu,i))};if(ht(e.clicked)){var l=q({sourceRow:n.row,destRow:e.row,piece:n.piece}),p=function(e,t){return(1===e||2===e)&&0===t||(-1===e||-2===e)&&8===t||3===e&&(0===t||1===t)||-3===e&&(8===t||7===t)}(n.piece,e.row);if(!l||p)s(p?_(n.piece):n.piece,p||void 0);else this.confirm={promoted:_(n.piece),preserved:n.piece,row:e.row,column:e.column}}else{s(e.promote?e.clicked.promoted:e.clicked.preserved,e.promote)}}}}}},{key:"clickKifu",value:function(e,t){var n,r,a;this.setKifu((n=this.kifu,r=e,a=t,{meta:n.meta,history:pe(n.history,r,a)}))}},{key:"setKifu",value:function(e){this.selected=null,this.confirm=null,this.moveTargets=[],this.kifu=e}},{key:"currentMove",get:function(){return Se(this.kifu)}}]),e}(),tt=Object(P.a)(et.prototype,"indexes",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[-1,0,1,2,3,4,5,6,7,8,9]}}),nt=Object(P.a)(et.prototype,"selected",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=Object(P.a)(et.prototype,"confirm",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=Object(P.a)(et.prototype,"moveTargets",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ot=Object(P.a)(et.prototype,"kifu",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ut()}}),it=Object(P.a)(et.prototype,"prevDestination",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(P.a)(et.prototype,"currentMove",[M.computed],Object.getOwnPropertyDescriptor(et.prototype,"currentMove"),et.prototype),Object(P.a)(et.prototype,"reverse",[M.action],Object.getOwnPropertyDescriptor(et.prototype,"reverse"),et.prototype),Object(P.a)(et.prototype,"clickPiece",[M.action],Object.getOwnPropertyDescriptor(et.prototype,"clickPiece"),et.prototype),Object(P.a)(et.prototype,"clickKifu",[M.action],Object.getOwnPropertyDescriptor(et.prototype,"clickKifu"),et.prototype),Object(P.a)(et.prototype,"setKifu",[M.action],Object.getOwnPropertyDescriptor(et.prototype,"setKifu"),et.prototype),et);function ht(e){return"number"===typeof e}var bt=(st=function(){function e(){var t=this;Object(T.a)(this,e),Object(R.a)(this,"gameState",lt,this),Object(R.a)(this,"engineState",pt,this),Object(R.a)(this,"displayState",ft,this),Object(R.a)(this,"config",vt,this),this.engineState.setServerURL(this.config.serverURL),Object(M.observe)(this.gameState,"currentMove",(function(e){return t.updatePosition(e.newValue)})),Object(M.observe)(this.config,"serverURL",(function(e){return t.engineState.setServerURL(e.newValue)}))}return Object(L.a)(e,[{key:"updatePosition",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.engineState.state>=2){e.next=3;break}return e.abrupt("return");case 3:n=t||this.gameState.currentMove,this.engineState.updatePosition(n.pos);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),lt=Object(P.a)(st.prototype,"gameState",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new mt}}),pt=Object(P.a)(st.prototype,"engineState",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new se}}),ft=Object(P.a)(st.prototype,"displayState",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D}}),vt=Object(P.a)(st.prototype,"config",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new B}}),st),dt=Object(k.createContext)(new bt),wt=(n(105),n(106),Object(E.a)((function(){var e=O.a.useContext(dt),t=e.engineState,n=e.gameState,r=t.result;if(!r)return O.a.createElement("div",null);var a=r.map((function(e){var t=n.prevDestination,r=e.moves.map((function(e,n){t&&(e.prevDest=t);var r=je(e);return t=e.dest,O.a.createElement("div",{key:n,className:"EngineInfoRowContent"},r)}));return O.a.createElement("div",{key:e.id,className:"EngineInfoColumn"},O.a.createElement("div",{className:"EngineInfoRow EngineInfoRowContainer"},O.a.createElement("div",{className:"EngineInfoRowLabel"},"score"),O.a.createElement("div",{className:"EngineInfoRowContent Center"},e.score)),O.a.createElement("div",{className:"EngineInfoRow EngineInfoRowContainer"},O.a.createElement("div",{className:"EngineInfoRowLabel"},"\u8aad\u307f"),r))}));return O.a.createElement(O.a.Fragment,null,a)}))),gt=(n(107),function(){return O.a.createElement("div",{className:"EngineSideInfo"},O.a.createElement("div",{className:"EngineSideInfoContainer"},O.a.createElement(wt,null)))}),yt=(n(108),Object(E.a)((function(){var e=O.a.useContext(dt),t=e.displayState,n=e.config,r=Object(k.useRef)(t),a=Object(k.useRef)(n);return Object(k.useEffect)((function(){document.addEventListener("mouseup",(function(){return function(){var e;r.current.resizing&&(null===(e=window.getSelection())||void 0===e||e.removeAllRanges()),r.current.setResizing(!1)}()})),document.addEventListener("mousemove",(function(e){return function(e){if(r.current.resizing){var t=a.current,n=document.getElementById("root").clientWidth,o=n-e.clientX;o<=0?t.setAppWidth():t.setAppWidth(n-2*o)}}(e)}))}),[]),O.a.createElement("div",{className:"WidthController",onMouseDown:function(){return t.setResizing(!0)}})}))),kt=(n(109),function(e){var t=r(0,0,20,20),n=r(20,0,0,20);return O.a.createElement("div",{onClick:function(){return e.onClick()}},O.a.createElement("svg",{width:20,height:20,className:"MockupCloseButton"},t,n));function r(e,t,n,r){return O.a.createElement("line",{x1:e,y1:t,x2:n,y2:r,stroke:"black",strokeWidth:"2"})}}),Ot=n(37),jt=n.n(Ot),xt=(n(110),n(111),Object(E.a)((function(e){return O.a.createElement("button",{className:"FormButton",onClick:function(){return e.onClick()}},e.label)}))),Et=(n(112),Object(E.a)((function(e){var t=Array.from(e.buttons).map((function(t){var n=Object(I.a)(t,2),r=n[0],a=n[1];return O.a.createElement(xt,{key:r,label:r,onClick:function(){return e.sbclient.updateButton(a)}})}));return O.a.createElement("div",{className:"OptionButton"},t)}))),Ct=(n(113),Object(E.a)((function(e){var t=e.label,n=e.value,r=e.name,a="FormCheck-".concat(r);return O.a.createElement("div",{className:"FormCheck"},O.a.createElement("span",null,t),O.a.createElement("div",{className:"FormCheckToggle"},O.a.createElement("input",{id:a,name:a,type:"checkbox",onChange:function(t){return e.onChange(t.target.checked)},checked:n}),O.a.createElement("label",{htmlFor:a},O.a.createElement("div",{className:"ToggleSwitch","data-checked":"ON","data-unchecked":"OFF"}))))}))),Nt=Object(E.a)((function(e){var t=Array.from(e.checks).map((function(t){var n=Object(I.a)(t,2),r=n[0],a=n[1];return O.a.createElement(Ct,{key:r,label:r,name:r,value:a.value,onChange:function(t){return a.setValue(t),e.sbclient.updateCheck(a)}})}));return O.a.createElement("div",null,t)})),St=Object(E.a)((function(e){var t=e.option,n=t.name,r=t.value,a=t.inputValue,o=t.min,i=t.max,c="FormTextInput"+(r.toString()===a?"":" FormTextInvalid"),u="".concat(n,"(").concat(o,"~").concat(i,")");return O.a.createElement("div",{className:"FormText"},O.a.createElement("input",{className:c,type:"text",value:a,placeholder:" ",onChange:function(t){var n=e.option,r=e.sbclient;return n.setValue(t.target.value),r.updateRange(n)},required:!0,min:o,max:i}),O.a.createElement("label",null,u))})),Rt=Object(E.a)((function(e){var t=e.ranges,n=e.sbclient,r=Array.from(t).map((function(e){var t=Object(I.a)(e,2),r=t[0],a=t[1];return O.a.createElement(St,{key:r,option:a,sbclient:n})}));return O.a.createElement("div",null,r)})),Tt=(n(114),Object(E.a)((function(e){var t=e.label,n=e.value,r=e.options.map((function(e,t){return O.a.createElement("option",{key:t,value:e},e)}));return O.a.createElement("div",{className:"FormSelectContainer"},O.a.createElement("label",null,t),O.a.createElement("div",{className:"FormSelect SelectTriangle"},O.a.createElement("select",{onChange:function(t){e.onChange(t.target.value)},value:n,required:!0},r)))}))),Lt=Object(E.a)((function(e){var t=Array.from(e.selects).map((function(t){var n=Object(I.a)(t,2),r=n[0],a=n[1];return O.a.createElement(Tt,{key:r,label:r,value:a.value,options:a.vars,onChange:function(t){return a.setValue(t),e.sbclient.updateSelect(a)}})}));return O.a.createElement("div",null,t)})),Pt=(n(115),Object(E.a)((function(e){var t=e.value,n=e.label,r=e.allowEmpty,a=e.placeholder,o=["FormTextInput"];r||""!==t||o.push("FormTextInvalid");var i=o.join(" ");return O.a.createElement("div",{className:"FormText"},O.a.createElement("input",{className:i,type:"text",value:t,placeholder:a||" ",onChange:function(t){e.onChange(t.target.value)},required:!0}),O.a.createElement("label",null,n))}))),Mt=Object(E.a)((function(e){var t=Array.from(e.texts).map((function(t){var n=Object(I.a)(t,2),r=n[0],a=n[1];return O.a.createElement(Pt,{key:r,label:r,value:a.value,onChange:function(t){return a.setValue(t),e.sbclient.updateText(a)}})}));return O.a.createElement("div",null,t)})),Wt=Object(E.a)((function(){var e=O.a.useContext(dt),t=e.gameState,n=e.displayState,r=e.engineState,a=r.current,o=r.options,i=r.sbclient;if(!a||!o)return O.a.createElement("div",null);var c=o.buttons,u=o.checks,s=o.ranges,l=o.selects,p=o.texts,f=O.a.createElement("button",{className:"ButtonDisconnect",onClick:function(){return r.disconnect()}},"\u63a5\u7d9a\u89e3\u9664"),v=O.a.createElement("button",{className:"ButtonStartThinking",onClick:function(){return r.startThinking().then((function(){return n.closeMockup()})).then(m).catch((function(e){return console.error(e)}))}},"\u601d\u8003\u958b\u59cb");return O.a.createElement("div",{className:"DetailContainer"},O.a.createElement("h1",{className:"EngineName"},a),f,v,O.a.createElement("h2",{className:"EngineOption"},"\u30aa\u30d7\u30b7\u30e7\u30f3"),O.a.createElement(Et,{buttons:c,sbclient:i}),O.a.createElement(Nt,{checks:u,sbclient:i}),O.a.createElement(Rt,{ranges:s,sbclient:i}),O.a.createElement(Lt,{selects:l,sbclient:i}),O.a.createElement(Mt,{texts:p,sbclient:i}),f,v);function m(){return jt()(function(){var e=Object(S.a)(N.a.mark((function e(n,a){var o,i,c,u;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.current,i=r.state,c=r.sbclient,o&&4===i){e.next=4;break}return a(),e.abrupt("return");case 4:return e.prev=4,e.next=7,c.getResult(t.currentMove);case 7:return u=e.sent,e.next=10,r.setResult(u);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n){return e.apply(this,arguments)}}(),1e3)}})),Ut=(n(116),function(){return O.a.createElement("div",{className:"Loader sk-fading-circle"},O.a.createElement("div",{className:"sk-circle1 sk-circle"}),O.a.createElement("div",{className:"sk-circle2 sk-circle"}),O.a.createElement("div",{className:"sk-circle3 sk-circle"}),O.a.createElement("div",{className:"sk-circle4 sk-circle"}),O.a.createElement("div",{className:"sk-circle5 sk-circle"}),O.a.createElement("div",{className:"sk-circle6 sk-circle"}),O.a.createElement("div",{className:"sk-circle7 sk-circle"}),O.a.createElement("div",{className:"sk-circle8 sk-circle"}),O.a.createElement("div",{className:"sk-circle9 sk-circle"}),O.a.createElement("div",{className:"sk-circle10 sk-circle"}),O.a.createElement("div",{className:"sk-circle11 sk-circle"}),O.a.createElement("div",{className:"sk-circle12 sk-circle"}))}),Bt=(n(117),Object(E.a)((function(){var e=O.a.useContext(dt),t=e.engineState,n=Object(k.useRef)(t),r=t.names,a=t.current,o=t.state;if(Object(k.useEffect)((function(){var e=n.current;e.sbclient.init().then((function(t){return e.setNames(t)})).catch((function(t){var n=["\u63a5\u7d9a\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u4ee5\u4e0b\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002","1. \u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u304b","2. \u30b5\u30fc\u30d0\u30fc\u306eURL\u304c\u6b63\u3057\u3044\u304b","3. \u30b5\u30fc\u30d0\u30fc\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3001\u30a8\u30e9\u30fc\u7b49\u304c\u51fa\u3066\u3044\u306a\u3044\u304b","4. \u30b5\u30fc\u30d0\u30fc\u3067\u5c06\u68cb\u30a8\u30f3\u30b8\u30f3\u306e\u5b9f\u884c\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u305f\u304b","5. \u5c06\u68cb\u30a8\u30f3\u30b8\u30f3\u304c\u5b9f\u884c\u53ef\u80fd\u3067\u3042\u308b\u304b"].join("\n");console.error(t),e.disconnect(),alert(n)}))}),[]),0===r.length)return O.a.createElement("div",{className:"ListEngineName"},O.a.createElement("span",null,"\u5229\u7528\u53ef\u80fd\u306a\u5c06\u68cb\u30a8\u30f3\u30b8\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"));var i=r.map((function(e,t){var n=e===a&&1===o?O.a.createElement(Ut,null):void 0;return O.a.createElement("div",{className:"ListEngineName",key:t,onClick:function(){return function(e,t){return c.apply(this,arguments)}(e,o)}},n,O.a.createElement("span",null,e))}));return O.a.createElement(O.a.Fragment,null,i);function c(){return(c=Object(S.a)(N.a.mark((function n(r,a){return N.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0===a){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.connect(r);case 4:return n.next=6,e.updatePosition().catch((function(e){return console.error(e)}));case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}}))),Dt=Object(E.a)((function(){var e=O.a.useContext(dt),t=e.engineState,n=e.displayState,r=t.state,a=0===r||1===r?O.a.createElement(Bt,null):O.a.createElement(Wt,null);return O.a.createElement("div",{className:"Mockup"},O.a.createElement(kt,{onClick:function(){return n.closeMockup()}}),a)}));function It(e){return e.history.moves.length<1?"":function e(t){return t.moves.map((function(t){return le(t)?e(t.branches[t.index]):"".concat(t.index," ").concat(t.str)})).join("\n")}({moves:e.history.moves.slice(1),index:e.history.index})}function zt(e){return{parse:e,map:function(t){return zt((function(n){var r=e(n);return r?{value:t(r.value),next:r.next}:null}))},comb:function(t){return zt((function(n){var r=e(n);if(!r)return null;var a=t.parse(r.next);return a?{value:[r.value,a.value],next:a.next}:null}))},left:function(t){return zt((function(n){var r=e(n);if(!r)return null;var a=t.parse(r.next);return a?{value:r.value,next:a.next}:null}))},right:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return zt((function(n){var r=e(n);if(!r)return null;var a=t.parse(r.next);return a?{value:a.value,next:a.next}:null}))})),or:function(t){return zt((function(n){var r;return null!==(r=e(n))&&void 0!==r?r:t.parse(n)}))},fallback:function(t){return zt((function(n){var r;return null!==(r=e(n))&&void 0!==r?r:Kt(t,n)}))},failif:function(t){return zt((function(n){var r=e(n);return!r||t(r.value)?null:r}))}}}function Kt(e,t){return{value:e,next:t}}var At=[" ","\t","\r","\n"],Vt=At.concat("\u3000"),Ft=Jt(Ht(At)).map((function(e){return e.join("")}));Jt(Ht(Vt)).map((function(e){return e.join("")}));var _t=function(e){return zt((function(t){return t.startsWith(e)?{value:e,next:t.substring(e.length)}:null}))},Gt=function(e){return t=_t(e),Ft.right(t).left(Ft);var t};function qt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht(At);return zt((function(t){if(0===t.length)return null;for(var n=0;n<t.length;n++)if(e.parse(t[n]))return Kt(t.substr(0,n),t.substring(n));return Kt(t,"")}))}function Jt(e){return zt((function(t){for(var n=[],r=t;;){var a=e.parse(r);if(!a)break;n.push(a.value),r=a.next}return{value:n,next:r}}))}function Ht(e){return zt((function(t){if(0===t.length)return null;for(var n=0;n<e.length;n++){if(1!==e[n].length)throw new Error("oneOf\u306e\u5f15\u6570\u306b\u306f\u306b\u306f1\u6587\u5b57\u3060\u3051\u3067\u69cb\u6210\u3055\u308c\u305f\u914d\u5217\u3092\u6e21\u3057\u3066\u304f\u3060\u3055\u3044");if(t[0]===e[n])return{value:t[0],next:t.substring(1)}}return null}))}var Xt=n(11);var $t,Qt,Yt=zt((function(e){var t=e[0],n=function(){return e.substring(1)};return"\u4e00"===t||"\uff11"===t||"1"===t?Kt(0,n()):"\u4e8c"===t||"\uff12"===t||"2"===t?Kt(1,n()):"\u4e09"===t||"\uff13"===t||"3"===t?Kt(2,n()):"\u56db"===t||"\uff14"===t||"4"===t?Kt(3,n()):"\u4e94"===t||"\uff15"===t||"5"===t?Kt(4,n()):"\u516d"===t||"\uff16"===t||"6"===t?Kt(5,n()):"\u4e03"===t||"\uff17"===t||"7"===t?Kt(6,n()):"\u516b"===t||"\uff18"===t||"8"===t?Kt(7,n()):"\u4e5d"===t||"\uff19"===t||"9"===t?Kt(8,n()):null})),Zt=zt((function(e){var t=e[0],n=function(){return e.substring(1)};return"\uff11"===t||"1"===t?Kt(0,n()):"\uff12"===t||"2"===t?Kt(1,n()):"\uff13"===t||"3"===t?Kt(2,n()):"\uff14"===t||"4"===t?Kt(3,n()):"\uff15"===t||"5"===t?Kt(4,n()):"\uff16"===t||"6"===t?Kt(5,n()):"\uff17"===t||"7"===t?Kt(6,n()):"\uff18"===t||"8"===t?Kt(7,n()):"\uff19"===t||"9"===t?Kt(8,n()):null})),en=Jt(zt((function(e){var t=e[0],n=e.substring(1);return"\uff10"===t||"0"===t?Kt(0,n):"\uff11"===t||"1"===t?Kt(1,n):"\uff12"===t||"2"===t?Kt(2,n):"\uff13"===t||"3"===t?Kt(3,n):"\uff14"===t||"4"===t?Kt(4,n):"\uff15"===t||"5"===t?Kt(5,n):"\uff16"===t||"6"===t?Kt(6,n):"\uff17"===t||"7"===t?Kt(7,n):"\uff18"===t||"8"===t?Kt(8,n):"\uff19"===t||"9"===t?Kt(9,n):null}))).failif((function(e){return 0===e.length})).map((function(e){for(var t=0,n=0;n<e.length;n++)t*=10,t+=e[n];return t})),tn=($t=en,Qt=_t(":"),$t.comb(Jt(Qt.right($t))).map((function(e){for(var t=Object(I.a)(e,2),n=t[0],r=t[1],a=[n],o=0;o<r.length;o++)a.push(r[o]);return a})).fallback([])).failif((function(e){return 0===e.length||e.length>3})).map((function(e){for(var t=0,n=0;n<e.length;n++)t*=60,t+=e[n];return t})),nn=Gt("\u5404").fallback(""),rn=en.left(Gt("\u6642\u9593")).fallback(0),an=en.left(Gt("\u5206")).fallback(0),on=en.left(Gt("\u79d2")).fallback(0),cn=nn.right(rn).comb(an).comb(on).map((function(e){var t=Object(I.a)(e,2),n=Object(I.a)(t[0],2);return 3600*n[0]+60*n[1]+t[1]})),un=_t("\n"),sn=Jt(Ht([" ","\t","\r"])).map((function(e){return e.join("")})),ln=function(e){return sn.right(_t(e)).left(sn)};var pn=function(e){var t=new Date(e);return isNaN(t.getTime())?null:t},fn=sn.right(_t("#")).right(qt(un).fallback("")).left(un),vn=fn.map((function(e){return["",""]})),mn=sn.right(un).map((function(e){return["",""]})),hn=_t("\uff1a"),bn=qt(hn).left(hn).comb(qt(un)).left(un),dn=function(e){return sn.right(e).left(sn)}(Jt(vn.or(mn).or(bn))).map((function(e){var t,n={version:ct,date:{},player:{sente:"",gote:""},handicap:De.hirate,other:new Map},r=Object(fe.a)(e);try{for(r.s();!(t=r.n()).done;){var a=Object(I.a)(t.value,2),o=a[0],i=a[1];if(""!==o)if("\u958b\u59cb\u65e5\u6642"===o){var c=pn(i);c?n.date.start=c:n.other.set(o,i)}else if("\u7d42\u4e86\u65e5\u6642"===o){var u=pn(i);u?n.date.end=u:n.other.set(o,i)}else if("\u68cb\u6226"===o)n.title=i;else if("\u5148\u624b"===o||"\u4e0b\u624b"===o)n.player.sente=i;else if("\u5f8c\u624b"===o||"\u4e0a\u624b"===o)n.player.gote=i;else if("\u5834\u6240"===o)n.place=i;else if("\u624b\u5408\u5272"===o)n.handicap=i;else if("\u6301\u3061\u6642\u9593"===o){var s=cn.parse(i);n.time={sente:s.value,gote:s.value}}else n.other.set(o,i)}}catch(l){r.e(l)}finally{r.f()}return n})),wn=Jt(_t("-")),gn=_t("\u624b\u6570").right(wn).right(_t("\u6307\u624b")).right(wn).right(_t("\u6d88\u8cbb\u6642\u9593")).right(wn).right(un).fallback(""),yn=ln("*").right(qt(un)).left(un),kn=function(e){var t=Object(I.a)(e,2);return{column:t[0],row:t[1]}},On=Zt.comb(Yt).map(kn),jn=_t("\u540c\u3000").or(_t("\u540c")),xn=ln("(").right(Zt).comb(Yt).left(ln(")")).or(_t("\u6253").map((function(e){return[-1,-1]}))).map(kn),En=tn,Cn=ln("(").right(En).left(ln("/")).comb(En).left(ln(")")).fallback([void 0,void 0]);function Nn(e){return sn.right(en).left(sn).comb(On.or((n=e.dest,jn.map((function(e){return{row:n.row,column:n.column}}))))).comb((t=e.pos.turn,zt((function(e){if(0===e.length)return null;var n=function(t){return e.startsWith(t)},r=function(n,r){return Kt(n*t,e.substring(r))};return n("\u6b69")?r(1,1):n("\u9999")?r(2,1):n("\u6842")?r(3,1):n("\u9280")?r(4,1):n("\u91d1")?r(5,1):n("\u7389")?r(8,1):n("\u89d2")?r(6,1):n("\u98db")?r(7,1):n("\u3068")?r(11,1):n("\u6210\u9999")?r(12,2):n("\u674f")?r(12,1):n("\u6210\u6842")?r(13,2):n("\u572d")?r(13,1):n("\u6210\u9280")?r(14,2):n("\u5168")?r(14,1):n("\u99ac")?r(16,1):n("\u9f8d")||n("\u7adc")?r(17,1):null})))).comb(_t("\u6210").fallback("")).comb(xn).comb(Cn).left(qt(un)).left(un).map((function(t){var n=Object(I.a)(t,2),r=Object(I.a)(n[0],2),a=Object(I.a)(r[0],2),o=Object(I.a)(a[0],2),i=Object(I.a)(o[0],2),c=i[0],u=i[1],s=o[1],l=a[1],p=r[1],f=Object(I.a)(n[1],2),v=f[0],m=f[1],h="\u6210"===l||!q({sourceRow:p.row,destRow:u.row,piece:s})&&void 0,b={source:p,dest:u,piece:h?_(s):s,prevDest:e.dest};void 0!==h&&(b.promote=h);var d=Object(Xt.a)(Object(Xt.a)({},b),{},{pos:e.pos}),w=Object(Xt.a)(Object(Xt.a)({},b),{},{pos:J(d)}),g=je(d),y={};return v&&(y.time=v),m&&(y.timeTotal=m),Object(Xt.a)(Object(Xt.a)({},w),{},{index:c,str:g},y)}));var t,n}var Sn=zt((function(e){var t=e.trimRight()+"\n",n=dn.left(gn.fallback("")).parse(t.replace(/\r/g,"")),r=n.value,a=n.next,o=ut(r.handicap);o.meta=r;for(var i=Se(o),c=a;;){var u=fn.parse(c);if(u)c=u.next;else{var s=yn.parse(c);if(s)i.comment=(i.comment||"")+s.value+"\n",c=s.next;else{var l=Nn(i).parse(c);if(!l)break;o=Re(o,l.value),i=l.value,c=l.next}}}return c===t?null:Kt(o,c)})),Rn="KIF";n(118);var Tn=function(){return O.a.createElement("div",{className:"checkmark-container"},O.a.createElement("div",{className:"checkmark draw"}))},Ln=(n(119),"standby"),Pn="parsing",Mn="success",Wn="failure",Un=Object(E.a)((function(){var e=Object(k.useState)(!1),t=Object(I.a)(e,2),n=t[0],r=t[1],a=Object(k.useState)(Ln),o=Object(I.a)(a,2),i=o[0],c=o[1],u=O.a.useContext(dt),s=u.gameState,l=u.displayState,p=s.kifu,f=function(){var e=Object(S.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=It(p),e.next=3,navigator.clipboard.writeText(t);case 3:r(!0),setTimeout((function(){return r(!1)}),1500);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v="https://github.com/murosan/shogi-board/issues/new",m=function(){var e=Object(S.a)(N.a.mark((function e(){var t,n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(Pn),e.next=3,navigator.clipboard.readText();case 3:if(t=e.sent,n=(a=Rn,a===Rn?Sn:zt((function(e){return null}))).parse(t)){e.next=10;break}return c(Wn),r=["\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002","\u4e0d\u5177\u5408\u5831\u544a\u306fissue\u3078\u304a\u9858\u3044\u3057\u307e\u3059\u3002",v].join("\n"),alert(r),e.abrupt("return");case 10:c(Mn),s.setKifu(n.value),l.closeMockup();case 13:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}();return O.a.createElement("div",{className:"Mockup"},O.a.createElement(kt,{onClick:function(){return l.closeMockup()}}),O.a.createElement("div",{className:"KifuMockupContent"},O.a.createElement("h1",null,"\u51fa\u529b"),O.a.createElement("div",{className:"OptionButton"},n?O.a.createElement(Tn,null):null,O.a.createElement(xt,{label:"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc",onClick:f}))),O.a.createElement("div",{className:"KifuMockupContent"},O.a.createElement("h1",null,"\u8aad\u307f\u8fbc\u307f"),O.a.createElement("p",null,"\u203bkif\u5f62\u5f0f\u306e\u307f\u5bfe\u5fdc"),O.a.createElement("div",{className:"OptionButton"},i===Pn?O.a.createElement(Ut,null):null,i===Mn?O.a.createElement(Tn,null):null,O.a.createElement(xt,{label:"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u304b\u3089\u8aad\u307f\u8fbc\u3080",onClick:m}))))})),Bn=Object(E.a)((function(){var e=O.a.useContext(dt),t=e.config,n=e.displayState,r=t.paintTargets,a=t.serverURL,o=t.saveToLocalStorage,i=t.saveBoardWidth;return O.a.createElement("div",{className:"Mockup"},O.a.createElement(kt,{onClick:function(){return n.closeMockup()}}),O.a.createElement("h1",null,"\u8a2d\u5b9a"),O.a.createElement(Pt,{label:"shogi-board-server \u306e URL",value:a,allowEmpty:!0,onChange:function(e){return t.setServerURL(e)},placeholder:"(\u4f8b)http://localhost:8080"}),O.a.createElement(Ct,{label:"\u99d2\u304c\u79fb\u52d5\u3067\u304d\u308b\u30de\u30b9\u306b\u8272\u3092\u4ed8\u3051\u308b",value:r,name:"PaintTargets",onChange:function(e){return t.setPaintTargets(e)}}),O.a.createElement(Ct,{label:"\u30d6\u30e9\u30a6\u30b6\u306b\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3059\u308b",value:o,name:"SaveToLocalStorage",onChange:function(e){return t.setSaveToLocalStorage(e)}}),O.a.createElement(Ct,{label:"\u76e4\u306e\u5e45\u3092\u8a18\u61b6\u3059\u308b",value:i,name:"SaveBoardWidth",onChange:function(e){return t.setSaveBoardWidth(e)}}))})),Dn=(n(120),n(38)),In=n.n(Dn),zn=n(39),Kn=n.n(zn),An=n(40),Vn=n.n(An),Fn=n(41),_n=n.n(Fn),Gn=n(42),qn=n.n(Gn),Jn=n(43),Hn=n.n(Jn),Xn=n(44),$n=n.n(Xn),Qn=n(45),Yn=n.n(Qn),Zn=n(46),er=n.n(Zn),tr=n(47),nr=n.n(tr),rr=n(48),ar=n.n(rr),or=n(49),ir=n.n(or),cr=n(50),ur=n.n(cr),sr=n(51),lr=n.n(sr),pr=n(52),fr=n.n(pr),vr=n(53),mr=n.n(vr),hr=n(54),br=n.n(hr),dr=n(55),wr=n.n(dr);n(121);function gr(e){return 0<=e&&e<=8}var yr=Object(E.a)((function(e){var t,n=O.a.useContext(dt),r=n.gameState,a=n.config,o=r.indexes,i=r.selected,c=r.confirm,u=r.currentMove,s=r.moveTargets,l=e.row,p=e.column,f=function(){return gr(l)&&gr(p)?r.currentMove.pos.pos[l][p]:0},v=f(),m=u.pos.turn,h=v>0&&1===m||v<0&&-1===m,b=a.paintTargets&&-1!==we(s,{row:l,column:p}),d=function(e){var t=e.r,n=e.c,r=e.sel,a=e.confirm,o=e.rv,i=e.isTurn,c=e.isTargeted;a&&r&&(t===r.row&&n===r.column||t===a.row&&n===a.column)&&(e.p=0);var u=["Cell"],s=gr(t),l=gr(n),p=s&&(!o&&8===n||o&&0===n),f=l&&(!o&&0===t||o&&8===t),v=!o&&(2===t&&6===n||2===t&&3===n||5===t&&6===n||5===t&&3===n)||o&&(6===t&&2===n||6===t&&5===n||3===t&&2===n||3===t&&5===n),m=s&&l&&!!r&&r.row===t&&r.column===n;s&&l&&(u.push("Piece"),u.push("Piece-Bordered"));var h=e.p&&o?-1*e.p:e.p;h&&u.push("Piece-".concat(h));i&&u.push("Piece-Turn");m&&u.push("Piece-Selected");c&&u.push("Piece-Targeted");p&&u.push("Piece-Left");f&&u.push("Piece-Top");(-1===n&&s||-1===t&&l)&&u.push("Cell-Edge");v&&u.push("Piece-Star");return u.join(" ")}({r:l,c:p,rv:9===o[0],p:v,sel:i,confirm:c,isTurn:h,isTargeted:b}),w=function(e){return{backgroundImage:"url(".concat(e,")")}};return gr(p)&&-1===l?t=w(0===p?In.a:1===p?Kn.a:2===p?Vn.a:3===p?_n.a:4===p?qn.a:5===p?Hn.a:6===p?$n.a:7===p?Yn.a:er.a):gr(l)&&-1===p&&(t=w(0===l?nr.a:1===l?ar.a:2===l?ir.a:3===l?ur.a:4===l?lr.a:5===l?fr.a:6===l?mr.a:7===l?br.a:wr.a)),O.a.createElement("div",{className:d,onClick:function(){return g()},style:t},function(e){if(!e||e.row!==l||e.column!==p)return;var t=9===o[0],n=t&&e.preserved>0||!t&&e.preserved<0,r="Piece-Confirm Piece-Confirm"+Number(n);return O.a.createElement("div",{className:r},O.a.createElement("div",{className:"Piece-Confirm-Promote",onClick:function(){return g(e,!0)}}),O.a.createElement("div",{className:"Piece-Confirm-Preserve",onClick:function(){return g(e)}}))}(c));function g(e,t){if(!c||e){var n={clicked:e||f(),row:l,column:p,promote:t};r.clickPiece(n)}}})),kr=Object(E.a)((function(){var e=O.a.useContext(dt),t=e.gameState,n=e.displayState,r=t.indexes,a=r.map((function(e){return r.slice().reverse().map((function(t){return O.a.createElement(yr,{key:10*e+t,row:e,column:t})}))}));return O.a.createElement("div",{className:"BoardContainer"},O.a.createElement("div",{className:"ResetPseudo"},O.a.createElement("div",{className:"Board"},a),function(){var e=n.mockup;if(2===e)return O.a.createElement(Dt,null);if(4===e||3===e)return O.a.createElement(Bn,null);if(5===e)return O.a.createElement(Un,null)}()))})),Or=(n(122),n(56)),jr=n.n(Or),xr=n(57),Er=n.n(xr),Cr=n(58),Nr=n.n(Cr),Sr=n(59),Rr=n.n(Sr),Tr=n(60),Lr=n.n(Tr),Pr=n(61),Mr=n.n(Pr),Wr=n(62),Ur=n.n(Wr),Br=n(63),Dr=n.n(Br),Ir=n(64),zr=n.n(Ir),Kr=(n(123),Object(E.a)((function(){var e=O.a.useContext(dt),t=e.gameState,n=e.displayState,r=e.engineState,a=e.config,o=t.currentMove.index,i=o-1<0?0:o-1,c=o+1,u=o-5<0?0:o-5,s=o+5,l=function(e){return t.clickKifu(e)},p=function(){var e=Object(S.a)(N.a.mark((function e(){var t,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.current,n=r.state,t&&4===n){e.next=5;break}return e.next=4,v();case 4:return e.abrupt("return",e.sent);case 5:return e.next=7,r.stopThinking();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(e){return{backgroundImage:"url(".concat(e,")")}};return O.a.createElement("div",{className:"ButtonsContainer"},O.a.createElement("button",{className:"PrevOne",onClick:function(){return l(i)},style:f(Ur.a)}),O.a.createElement("button",{className:"NextOne",onClick:function(){return l(c)},style:f(Lr.a)}),O.a.createElement("button",{className:"PrevFive",onClick:function(){return l(u)},style:f(Mr.a)}),O.a.createElement("button",{className:"NextFive",onClick:function(){return l(s)},style:f(Rr.a)}),O.a.createElement("button",{className:"Reverse",onClick:function(){return t.reverse()},style:f(Dr.a)}),O.a.createElement("button",{className:"CopyOrRead",onClick:function(){return n.setMockupState(5)},style:f(Nr.a)}),O.a.createElement("button",{className:"ConnectToEngine",onClick:p,style:4===r.state?f(zr.a):f(Er.a)}),O.a.createElement("button",{className:"Configuration",onClick:function(){return n.setMockupState(4)},style:f(jr.a)}));function v(){return m.apply(this,arguments)}function m(){return(m=Object(S.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a.serverURL){e.next=4;break}return e.next=3,n.setMockupState(3);case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,n.setMockupState(2);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}))),Ar=(n(124),Object(E.a)((function(e){var t=O.a.useContext(dt).gameState,n=t.selected,r=t.currentMove,a=e.captures,o=e.isLeftSide,i=e.isTurn,c="Captures Captures"+Number(o);return O.a.createElement("div",{className:c},u("Hisha",7,a[6]),u("Kaku",6,a[5]),u("Kin",5,a[4]),u("Gin",4,a[3]),u("Kei",3,a[2]),u("Kyou",2,a[1]),u("Fu",1,a[0]));function u(e,a,c){var u=r.pos.turn,s=Array.from(Array(c).keys()).map((function(r){var s=i?function(e,t){return n&&n.piece&&-1===n.row&&-1===n.column&&Math.abs(n.piece)===e&&n.i===t?"Piece-Selected":""}(a,r):"",l=i?"Piece-Turn":"",p=o?-a:a,f=Number(o),v="Capture-".concat(a).concat(f).concat(c).concat(r+1),m="Piece Piece-".concat(p," ").concat(l," ").concat(s," ").concat(v),h="Cap-".concat(f,"-").concat(e,"-").concat(r);return O.a.createElement("div",{key:h,className:m,onClick:function(){if(i){var e=u*a;t.clickPiece({clicked:e,row:-1,column:-1,i:r})}}})})),l="Captures-Inner Captures-".concat(e);return O.a.createElement("div",{className:l},s)}}))),Vr=(n(125),Object(E.a)((function(){var e=O.a.useContext(dt).gameState,t=e.indexes,n=e.currentMove.pos,r=n.turn,a=n.cap0,o=n.cap1,i=-1===t[0]?o:a,c=-1===t[0]?-1===r:1===r;return O.a.createElement("div",{className:"LeftSide"},O.a.createElement(Ar,{isLeftSide:!0,captures:i,isTurn:c}),O.a.createElement("div",{className:"LeftInfo"},O.a.createElement("div",null),O.a.createElement(Kr,null)))}))),Fr=n(65);n(126);var _r=Object(E.a)((function(){var e=O.a.useContext(dt).gameState;Object(k.useEffect)((function(){!function(e){var t=document.getElementById(e);t&&t.scrollIntoViewIfNeeded&&t.scrollIntoViewIfNeeded()}("Move-Current")}));var t=n(e.kifu.history.moves,0);return O.a.createElement("div",{className:"KifuContainer"},O.a.createElement("div",{className:"Kifu-Inner"},t));function n(t,o){return t.flatMap((function(t,i){return le(t)?function(t,o){for(var i=t.branches[t.index],c=Object(Fr.a)(i.moves),u=c[0],s=c.slice(1),l=[],p=function(n){if(n===t.index)return"continue";var r=t.branches[n].moves[0],i="".concat(o,"-").concat(n),c="-- ".concat(a(r));l.push(O.a.createElement("div",{key:i,className:"Branch",onClick:function(){return e.clickKifu(o,n)}},O.a.createElement("span",null,c)))},f=0;f<t.branches.length;f++)p(f);var v=0!==s.length?n(s,o+1):[];return[r(u,o)].concat(l).concat(v)}(t,o+i):r(t,o+i)}))}function r(t,n){var r=e.currentMove.index===n?"Move-Current":void 0;return O.a.createElement("div",{key:n,className:"Move",id:r,onClick:function(){return e.clickKifu(n)}},O.a.createElement("div",{className:"Number code"},n+"."),O.a.createElement("div",{className:"MoveText"},a(t)))}function a(e){var t=e.str;return 2===t.length&&"\u540c"===t[0]?"\u540c\u3000".concat(t[1]):t}})),Gr=(n(127),Object(E.a)((function(){var e=O.a.useContext(dt).gameState,t=e.indexes,n=e.currentMove.pos,r=n.turn,a=n.cap0,o=n.cap1,i=9===t[0]?o:a,c=9===t[0]?-1===r:1===r;return O.a.createElement("div",{className:"RightSide"},O.a.createElement("div",{className:"RightInfo"},O.a.createElement(_r,null)),O.a.createElement(Ar,{isLeftSide:!1,captures:i,isTurn:c}))}))),qr=function(){return O.a.createElement("div",{className:"BoardArea"},O.a.createElement(Vr,null),O.a.createElement(kr,null),O.a.createElement(Gr,null))},Jr=Object(E.a)((function(){var e=O.a.useContext(dt),t=e.engineState,n=e.config.appWidth,r=4===t.state,a=["App"];if(r?a.push("App-SideInfo"):a.push("App-BoardOnly"),n){var o=function(e){return r?2*e/3:e};n>=o(1500)&&a.push("Border-3"),n>=o(800)&&a.push("Border-2"),a.push("Border-1")}var i=a.join(" "),c={width:n?"".concat(n,"px"):"100%"};return O.a.createElement("div",{className:"AppContainer",style:c},O.a.createElement(yt,null),O.a.createElement("div",{className:i},O.a.createElement(qr,null),r?O.a.createElement(gt,null):null))})),Hr=(n(128),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Xr(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}x.a.render(O.a.createElement(Jr,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/shogi-board/playground",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/shogi-board/playground","/service-worker.js");Hr?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Xr(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):Xr(t,e)}))}}()}]),[[66,1,2]]]);
//# sourceMappingURL=main.3a943cca.chunk.js.map